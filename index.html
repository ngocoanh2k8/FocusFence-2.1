<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FocusFence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./index.css">
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.27.0"
  }
}
</script>
</head>
<body class="min-h-screen font-sans p-4 md:p-8 flex items-center justify-center">

    <!-- Email Capture Screen -->
    <div id="email-capture-screen" class="hidden w-full">
        <div class="max-w-md mx-auto w-full text-center">
            <header class="mb-8 relative">
                <button id="theme-toggle-email" class="absolute top-0 right-0 p-2 rounded-full bg-slate-200/50 dark:bg-slate-800/50 text-slate-600 dark:text-slate-300 hover:bg-slate-300/70 dark:hover:bg-slate-700/70 transition-colors" aria-label="Toggle theme">
                    <!-- Moon Icon -->
                    <svg id="theme-icon-moon-email" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                    <!-- Sun Icon -->
                    <svg id="theme-icon-sun-email" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                </button>
                <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-500 via-purple-500 to-green-500 leading-tight">
                    FocusFence
                </h1>
            </header>
            <div class="bg-white/50 dark:bg-slate-900/50 backdrop-blur-sm border border-slate-200 dark:border-slate-700 rounded-xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-2">C√πng t√¨m hi·ªÉu v·ªÅ b·∫°n nh√©!</h2>
                <p class="text-slate-600 dark:text-slate-400 mb-6">
                    C√° nh√¢n h√≥a g√≥c h·ªçc t·∫≠p v√† nh·∫≠n l·ªùi nh·∫Øc ƒë·ªÉ lu√¥n t·∫≠p trung
                </p>
                <form id="email-capture-form" class="space-y-4 text-left">
                    <div>
                        <label class="text-sm font-medium text-slate-700 dark:text-slate-300 mb-1 block">H·ªç v√† T√™n</label>
                        <input id="name-input" type="text" placeholder="v√≠ d·ª•: Nguy·ªÖn VƒÉn A" class="w-full bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-3 text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-purple-500 focus:outline-none transition-all" required />
                    </div>
                    <div>
                        <label class="text-sm font-medium text-slate-700 dark:text-slate-300 mb-1 block">ƒê·ªãa ch·ªâ Email</label>
                        <input id="email-input" type="email" placeholder="email.cua.ban@truong.edu" class="w-full bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-3 text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-purple-500 focus:outline-none transition-all" required />
                    </div>

                    <div class="flex items-start !mt-5">
                        <div class="flex items-center h-5">
                            <input id="reminders-checkbox" type="checkbox" class="focus:ring-purple-500 h-4 w-4 text-purple-600 border-slate-300 dark:border-slate-600 rounded bg-slate-100 dark:bg-slate-700">
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="reminders-checkbox" class="font-medium text-slate-700 dark:text-slate-300">Nh·∫≠n l·ªùi nh·∫Øc t·∫≠p trung h√†ng ng√†y</label>
                            <p class="text-xs text-slate-500 dark:text-slate-400">Ch√∫ng t√¥i s·∫Ω g·ª≠i th√¥ng b√°o qua tr√¨nh duy·ªát ƒë·ªÉ gi√∫p b·∫°n b·∫Øt ƒë·∫ßu ng√†y m·ªõi.</p>
                        </div>
                    </div>

                    <p id="email-error" class="text-red-500 text-sm text-center hidden"></p>
                    
                    <button type="submit" class="w-full text-center bg-gradient-to-r from-blue-500 via-purple-500 to-green-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-4 focus:ring-purple-300/50 !mt-6 hover:scale-102 active:scale-98">
                        B·∫Øt ƒë·∫ßu h·ªçc
                    </button>
                </form>
                <p class="text-xs text-slate-500 dark:text-slate-400 mt-4 text-center">
                    Ch√∫ng t√¥i t√¥n tr·ªçng quy·ªÅn ri√™ng t∆∞ c·ªßa b·∫°n. D·ªØ li·ªáu c·ªßa b·∫°n ƒë∆∞·ª£c l∆∞u tr·ªØ c·ª•c b·ªô v√† kh√¥ng bao gi·ªù ƒë∆∞·ª£c chia s·∫ª.
                </p>
            </div>

            <!-- Why FocusFence? Section -->
            <div class="mt-8 bg-white/50 dark:bg-slate-900/50 backdrop-blur-sm border border-slate-200 dark:border-slate-700 rounded-xl shadow-lg p-6 md:p-8 text-left">
                <h3 class="text-2xl font-bold text-slate-900 dark:text-white mb-4 text-center">T·∫°i sao FocusFence l√† d√†nh cho b·∫°n?</h3>
                <p class="text-slate-600 dark:text-slate-400 mb-6 text-center">
                    Trong k·ª∑ nguy√™n c·ªßa TikTok v√† Reels, kh·∫£ nƒÉng t·∫≠p trung s√¢u ƒëang d·∫ßn tr·ªü th√†nh m·ªôt "si√™u nƒÉng l·ª±c". FocusFence ƒë∆∞·ª£c sinh ra ƒë·ªÉ gi√∫p b·∫°n r√®n luy·ªán l·∫°i s·ª©c m·∫°nh ƒë√≥.
                </p>
                <ul class="space-y-4">
                    <li class="flex items-start">
                        <span class="text-2xl mr-4 mt-1">üíé</span>
                        <div>
                            <h4 class="font-semibold text-slate-800 dark:text-slate-200">Nu√¥i D∆∞·ª°ng Tinh Th·ªÉ T·∫≠p Trung</h4>
                            <p class="text-sm text-slate-600 dark:text-slate-400">Bi·∫øn m·ªói phi√™n h·ªçc th√†nh m·ªôt tr√≤ ch∆°i. Ho√†n th√†nh m·ª•c ti√™u ƒë·ªÉ nu√¥i l·ªõn nh·ªØng tinh th·ªÉ qu√Ω gi√°, ghi nh·∫≠n n·ªó l·ª±c c·ªßa b·∫°n m·ªôt c√°ch tr·ª±c quan.</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-2xl mr-4 mt-1">üì¨</span>
                        <div>
                            <h4 class="font-semibold text-slate-800 dark:text-slate-200">H·ªôp Th·ªùi Gian Cam K·∫øt</h4>
                            <p class="text-sm text-slate-600 dark:text-slate-400">G·ª≠i g·∫Øm m·ª•c ti√™u v√† quy·∫øt t√¢m c·ªßa b·∫°n v√†o nh·ªØng "l√° th∆∞ cho t∆∞∆°ng lai". ƒê·ªçc l·∫°i ch√∫ng ƒë·ªÉ th·∫•y b·∫°n ƒë√£ tr∆∞·ªüng th√†nh v√† m·∫°nh m·∫Ω h∆°n nh∆∞ th·∫ø n√†o.</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-2xl mr-4 mt-1">üõ°Ô∏è</span>
                        <div>
                            <h4 class="font-semibold text-slate-800 dark:text-slate-200">T·∫•m Ch·∫Øn Xao Nh√£ng Th√¥ng Minh</h4>
                            <p class="text-sm text-slate-600 dark:text-slate-400">Khi phi√™n h·ªçc b·∫Øt ƒë·∫ßu, ·ª©ng d·ª•ng s·∫Ω chuy·ªÉn sang to√†n m√†n h√¨nh v√† c·∫£nh b√°o khi b·∫°n r·ªùi ƒëi, gi√∫p b·∫°n gi·ªØ v·ªØng k·ª∑ lu·∫≠t v√† ch·ªëng l·∫°i c√°m d·ªó.</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-2xl mr-4 mt-1">üìà</span>
                        <div>
                            <h4 class="font-semibold text-slate-800 dark:text-slate-200">Th·ªëng K√™ & L·ªãch Tr√¨nh C√° Nh√¢n</h4>
                            <p class="text-sm text-slate-600 dark:text-slate-400">Theo d√µi t·ªïng th·ªùi gian t·∫≠p trung, s·ªë tinh th·ªÉ ƒë√£ nu√¥i v√† x√¢y d·ª±ng m·ªôt l·ªãch tr√¨nh h·ªçc t·∫≠p khoa h·ªçc ƒë·ªÉ bi·∫øn vi·ªác h·ªçc th√†nh th√≥i quen.</p>
                        </div>
                    </li>
                </ul>
                <div class="mt-6 pt-4 border-t border-slate-200 dark:border-slate-700">
                    <p class="text-slate-700 dark:text-slate-300 font-semibold text-center">
                        FocusFence kh√¥ng ch·ªâ l√† m·ªôt c√¥ng c·ª• ƒë·∫øm gi·ªù. ƒê√¢y l√† ph√≤ng gym cho n√£o b·ªô, gi√∫p b·∫°n r√®n luy·ªán l·∫°i "c∆° b·∫Øp" t·∫≠p trung ƒë·ªÉ chinh ph·ª•c nh·ªØng ki·∫øn th·ª©c s√¢u v√† ph·ª©c t·∫°p nh·∫•t.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application Screen -->
    <div id="main-app-screen" class="hidden w-full">
        <div class="max-w-2xl mx-auto w-full">
            <header class="text-center mb-6 relative">
                <button id="theme-toggle-main" class="absolute top-0 right-0 p-2 rounded-full bg-slate-200/50 dark:bg-slate-800/50 text-slate-600 dark:text-slate-300 hover:bg-slate-300/70 dark:hover:bg-slate-700/70 transition-colors" aria-label="Chuy·ªÉn ƒë·ªïi giao di·ªán">
                    <!-- Moon Icon -->
                    <svg id="theme-icon-moon-main" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                    <!-- Sun Icon -->
                    <svg id="theme-icon-sun-main" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                </button>
                <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-500 via-purple-500 to-green-500">
                    Ch√†o m·ª´ng, <span id="student-name"></span>!
                </h1>
                <p class="mt-2 text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto">
                    B·∫£ng ƒëi·ªÅu khi·ªÉn c√° nh√¢n c·ªßa b·∫°n ƒë·ªÉ ch·∫∑n phi·ªÅn nhi·ªÖu v√† chinh ph·ª•c b√†i v·ªü.
                </p>
            </header>

            <main class="space-y-6">
                <!-- Dashboard View (Progress + Daily Reward) -->
                <div class="px-2 space-y-4">
                    <!-- Progress Bar -->
                    <div id="progress-bar-container" class="bg-white/50 dark:bg-slate-900/50 backdrop-blur-sm border border-slate-200 dark:border-slate-700 rounded-xl shadow-md p-4 w-full">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-sm font-semibold text-slate-800 dark:text-slate-200">Ti·∫øn ƒë·ªô c·ªôt m·ªëc</h3>
                            <span id="total-crystals-grown" class="text-sm font-bold text-purple-600 dark:text-purple-400">0 Tinh th·ªÉ ƒë√£ nu√¥i</span>
                        </div>
                        <div class="relative h-3 bg-slate-200/80 dark:bg-slate-700/80 rounded-full overflow-hidden border border-slate-300/50 dark:border-slate-600/50">
                            <div id="progress-bar-fill" class="absolute top-0 left-0 h-full bg-gradient-to-r from-cyan-400 to-purple-500 rounded-full" style="width: 0%;"></div>
                        </div>
                        <div class="text-xs text-slate-500 dark:text-slate-400 mt-1.5 text-right">
                            C·ªôt m·ªëc ti·∫øp theo: <span id="next-milestone" class="font-semibold">1 tinh th·ªÉ</span>
                        </div>
                    </div>
                     <!-- Action Buttons -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div id="daily-reward-container" class="bg-amber-100/40 dark:bg-amber-900/20 backdrop-blur-sm border border-amber-300/50 dark:border-amber-800/50 rounded-xl shadow-md p-4 w-full flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div id="daily-reward-icon" class="text-3xl">üéÅ</div>
                                <div>
                                    <h3 class="font-semibold text-amber-900 dark:text-amber-200">Ph·∫ßn th∆∞·ªüng h√†ng ng√†y</h3>
                                    <p id="daily-reward-text" class="text-xs text-amber-700 dark:text-amber-300">Nu√¥i 1 tinh th·ªÉ h√¥m nay ƒë·ªÉ m·ªü kh√≥a!</p>
                                </div>
                            </div>
                            <button id="claim-reward-button" class="hidden bg-amber-400 hover:bg-amber-500 text-amber-900 font-bold text-sm py-2 px-4 rounded-lg shadow-md transition-colors hover:scale-105 active:scale-95">
                                Nh·∫≠n
                            </button>
                        </div>
                        <button id="show-review-btn" class="bg-indigo-100/40 dark:bg-indigo-900/20 backdrop-blur-sm border border-indigo-300/50 dark:border-indigo-800/50 rounded-xl shadow-md p-4 w-full flex items-center justify-center gap-3 text-indigo-900 dark:text-indigo-200 hover:bg-indigo-200/50 dark:hover:bg-indigo-900/40 transition-colors">
                            <span class="text-3xl">üì¨</span>
                            <span class="font-semibold">M·ªü H·ªôp Th·ªùi Gian</span>
                        </button>
                    </div>
                </div>

                <!-- Configurator View -->
                <div id="configurator-view">
                    <div class="bg-white/50 dark:bg-slate-900/50 backdrop-blur-sm border border-slate-200 dark:border-slate-700 rounded-xl shadow-lg overflow-hidden">
                        <div class="p-6 text-center">
                            <h2 class="text-2xl font-bold text-slate-900 dark:text-white">Ki·∫øn t·∫°o tinh th·ªÉ t·∫≠p trung</h2>
                            <p class="mt-1 text-slate-600 dark:text-slate-400">ƒê·∫∑t th·ªùi gian v√† g·ª≠i g·∫Øm cam k·∫øt c·ªßa b·∫°n v√†o H·ªôp Th·ªùi Gian.</p>
                            <div class="my-6 flex justify-center">
                                <svg id="crystal-svg-config" width="300" height="300" viewBox="0 0 200 200" aria-label="M·ªôt tinh th·ªÉ ƒëang l·ªõn d·∫ßn, ƒë·∫°i di·ªán cho ti·∫øn tr√¨nh c·ªßa phi√™n t·∫≠p trung">
                                    <defs>
                                        <linearGradient id="grad-main-config" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#a855f7;stop-opacity:1" /><stop offset="100%" style="stop-color:#6366f1;stop-opacity:1" /></linearGradient>
                                        <linearGradient id="grad-side-config" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" /><stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" /></linearGradient>
                                        <linearGradient id="grad-withered-config" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#6b7280;stop-opacity:1" /><stop offset="100%" style="stop-color:#4b5563;stop-opacity:1" /></linearGradient>
                                        <filter id="glow-filter-config"><feGaussianBlur in="SourceGraphic" stdDeviation="10" /></filter>
                                    </defs>
                                    <g id="crystal-base-config" style="opacity: 0; transition: opacity 1s ease;"><path d="M 10 190 Q 100 180 190 190" stroke="#a78bfa" stroke-width="2" fill="transparent" opacity="0.5"></path></g>
                                    <g id="crystal-main-shard-config" style="transform-origin: 50% 190px; transition: transform 1s ease-out; transform: scaleY(0);"><polygon points="100,50 115,130 100,190 85,130" fill="url(#grad-main-config)"/></g>
                                    <g id="crystal-left-shard-config" style="transform-origin: 85px 190px; transition: transform 1s ease-out 0.2s; transform: scale(0);"><polygon points="85,130 60,150 80,190" fill="url(#grad-side-config)"/></g>
                                    <g id="crystal-right-shard-config" style="transform-origin: 115px 190px; transition: transform 1s ease-out 0.2s; transform: scale(0);"><polygon points="115,130 140,150 120,190" fill="url(#grad-side-config)"/></g>
                                    <g id="crystal-glow-config" style="transition: opacity 1s ease-out 0.5s; opacity: 0;"><path d="M 85 130 L 100 50 L 115 130 L 140 150 L 120 190 L 80 190 L 60 150 Z" fill="#c4b5fd" filter="url(#glow-filter-config)" opacity="0.5"/></g>
                                </svg>
                            </div>
                        </div>
                        <form id="config-form">
                            <div class="bg-slate-50/70 dark:bg-black/20 p-6 border-t border-slate-200 dark:border-slate-700 space-y-8">
                                <div class="flex bg-slate-200 dark:bg-slate-800 rounded-lg p-1 max-w-sm mx-auto">
                                    <button id="manual-mode-btn" type="button" class="w-1/2 rounded-md py-2 text-sm font-medium transition-colors bg-white dark:bg-slate-700 text-purple-700 dark:text-purple-400 shadow">Phi√™n th·ªß c√¥ng</button>
                                    <button id="scheduled-mode-btn" type="button" class="w-1/2 rounded-md py-2 text-sm font-medium transition-colors text-slate-600 dark:text-slate-300 hover:bg-white/50 dark:hover:bg-slate-700/50">L·ªãch t·∫≠p trung</button>
                                </div>
                                <div id="manual-config-panel">
                                    <label for="duration-input" class="block text-lg font-semibold text-slate-800 dark:text-slate-200 mb-4 text-center">ƒê·∫∑t th·ªùi gian phi√™n h·ªçc</label>
                                    <div class="flex items-baseline justify-center gap-2 max-w-sm mx-auto">
                                        <input id="duration-input" type="number" min="1" placeholder="25" value="25" class="w-48 text-center text-5xl font-bold font-mono bg-transparent border-b-2 border-slate-300 dark:border-slate-600 focus:border-purple-500 dark:focus:border-purple-400 focus:outline-none transition-colors py-2 text-purple-600 dark:text-purple-400">
                                        <span class="text-slate-500 dark:text-slate-400 font-medium text-lg self-end pb-2">ph√∫t</span>
                                    </div>
                                </div>
                                <div id="scheduled-config-panel" class="hidden space-y-6">
                                   <h3 class="block text-lg font-semibold text-slate-800 dark:text-slate-200 text-center">Thi·∫øt l·∫≠p l·ªãch tr√¨nh c·ªßa b·∫°n</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label for="start-time" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Th·ªùi gian b·∫Øt ƒë·∫ßu</label>
                                            <input type="time" id="start-time" value="09:00" class="w-full bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-md px-3 py-2 text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-purple-500">
                                        </div>
                                        <div>
                                            <label for="end-time" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Th·ªùi gian k·∫øt th√∫c</label>
                                            <input type="time" id="end-time" value="17:00" class="w-full bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-md px-3 py-2 text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-purple-500">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">C√°c ng√†y l·∫∑p l·∫°i</label>
                                        <div id="days-of-week-container" class="flex flex-wrap gap-2"></div>
                                    </div>
                                    <p class="text-xs text-slate-500 text-center">C√°c phi√™n ƒë√£ l√™n l·ªãch s·∫Ω t·ª± ƒë·ªông b·∫Øt ƒë·∫ßu n·∫øu ·ª©ng d·ª•ng ƒë∆∞·ª£c m·ªü trong th·ªùi gian ƒë√£ ƒë·∫∑t.</p>
                                </div>
                                <div class="!mt-6">
                                    <div class="flex items-center justify-center gap-3 mb-3">
                                        <label for="letter-input" class="text-lg font-semibold text-slate-800 dark:text-slate-200">G·ª≠i g·∫Øm cam k·∫øt</label>
                                        <input id="letter-color-picker" type="color" value="#ffffff" class="w-8 h-8 p-0 border-none rounded-full cursor-pointer bg-transparent">
                                    </div>
                                    <textarea id="letter-input" rows="3" class="w-full bg-white/80 dark:bg-slate-800/80 border border-slate-300 dark:border-slate-600 rounded-lg p-3 text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-purple-500 focus:outline-none transition-all" placeholder="Vi·∫øt m·ªôt l√° th∆∞ cho ch√≠nh m√¨nh trong t∆∞∆°ng lai. T·∫°i sao phi√™n h·ªçc n√†y l·∫°i quan tr·ªçng?"></textarea>
                                </div>
                            </div>
                            <div class="p-6 bg-white/50 dark:bg-slate-900/50 border-t border-slate-200 dark:border-slate-700">
                                <button type="submit" class="w-full text-center bg-gradient-to-r from-blue-500 via-purple-500 to-green-500 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-4 focus:ring-purple-300/50 hover:scale-102 active:scale-98">
                                    <span id="submit-config-text">Kh√≥a H·ªôp & B·∫Øt ƒë·∫ßu</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Active Session View -->
                <div id="session-view" class="hidden">
                    <div id="time-lockbox-view" class="bg-white/50 dark:bg-slate-900/50 backdrop-blur-sm border-2 border-slate-400 dark:border-slate-600 rounded-xl shadow-lg text-center relative overflow-hidden">
                        <div class="absolute top-0 left-0 right-0 p-2 bg-slate-200/50 dark:bg-slate-800/50 border-b-2 border-slate-400 dark:border-slate-600">
                            <h2 class="text-sm font-bold text-slate-700 dark:text-slate-300 uppercase tracking-widest">üîí H·ªôp Th·ªùi Gian - ƒê√£ Kh√≥a</h2>
                        </div>
                         <div class="p-6 md:p-8 pt-16">
                            <p id="session-subheader" class="text-slate-600 dark:text-slate-400 mb-2">H√£y ·ªü l·∫°i ƒë√¢y. Tinh th·ªÉ c·ªßa b·∫°n ƒëang ph√°t tri·ªÉn b√™n trong.</p>

                            <div id="crystal-container-session" class="my-6 flex justify-center">
                               <svg id="crystal-svg-session" width="300" height="300" viewBox="0 0 200 200" aria-label="M·ªôt tinh th·ªÉ ƒëang l·ªõn d·∫ßn, ƒë·∫°i di·ªán cho ti·∫øn tr√¨nh c·ªßa phi√™n t·∫≠p trung">
                                   <defs>
                                        <linearGradient id="grad-main-session" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#a855f7;stop-opacity:1" /><stop offset="100%" style="stop-color:#6366f1;stop-opacity:1" /></linearGradient>
                                        <linearGradient id="grad-side-session" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" /><stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" /></linearGradient>
                                        <linearGradient id="grad-withered-session" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#6b7280;stop-opacity:1" /><stop offset="100%" style="stop-color:#4b5563;stop-opacity:1" /></linearGradient>
                                        <filter id="glow-filter-session"><feGaussianBlur in="SourceGraphic" stdDeviation="10" /></filter>
                                    </defs>
                                    <g id="crystal-base-session" style="opacity: 0; transition: opacity 1s ease;"><path d="M 10 190 Q 100 180 190 190" stroke="#a78bfa" stroke-width="2" fill="transparent" opacity="0.5"></path></g>
                                    <g id="crystal-main-shard-session" style="transform-origin: 50% 190px; transition: transform 1s linear; "><polygon points="100,50 115,130 100,190 85,130" fill="url(#grad-main-session)"/></g>
                                    <g id="crystal-left-shard-session" style="transform-origin: 85px 190px; transition: transform 1s linear; "><polygon points="85,130 60,150 80,190" fill="url(#grad-side-session)"/></g>
                                    <g id="crystal-right-shard-session" style="transform-origin: 115px 190px; transition: transform 1s linear; "><polygon points="115,130 140,150 120,190" fill="url(#grad-side-session)"/></g>
                                    <g id="crystal-glow-session" style="transition: opacity 1s linear; opacity: 0;"><path d="M 85 130 L 100 50 L 115 130 L 140 150 L 120 190 L 80 190 L 60 150 Z" fill="#c4b5fd" filter="url(#glow-filter-session)" opacity="0.5"/></g>
                                </svg>
                            </div>
                            
                            <!-- Timer -->
                            <div id="timer-container" class="w-full my-6">
                                <div id="timer-display" class="text-5xl md:text-7xl font-bold tracking-tighter text-purple-500 dark:text-purple-400 mb-4 font-mono">
                                    <span>00</span><span class="animate-pulse relative -top-2 md:-top-3 mx-1">:</span><span>00</span><span class="animate-pulse relative -top-2 md:-top-3 mx-1">:</span><span>00</span>
                                </div>
                                <div class="h-4 w-full bg-slate-200/80 dark:bg-slate-700/80 rounded-full overflow-hidden border border-slate-300 dark:border-slate-600">
                                    <div id="timer-progress-bar" class="h-full bg-gradient-to-r from-blue-400 via-purple-500 to-green-400 rounded-full" style="width: 100%; transition: width 1s linear;"></div>
                                </div>
                            </div>
    
                            <div id="success-message-container" class="hidden my-6">
                                <h2 id="session-header" class="text-2xl font-bold text-slate-900 dark:text-white"></h2>
                                <div id="ai-coach-container" class="mt-6 text-left max-w-lg mx-auto hidden">
                                    <p class="text-sm font-semibold text-slate-600 dark:text-slate-400 mb-2">L·ªùi nh·∫Øn t·ª´ Coach AI:</p>
                                    <blockquote id="ai-coach-message" class="bg-blue-100/50 dark:bg-blue-900/20 border-l-4 border-blue-400 dark:border-blue-600 p-4 rounded-r-lg text-slate-700 dark:text-slate-300 transition-opacity duration-500 italic">
                                        <!-- Content will be injected by JS -->
                                    </blockquote>
                                </div>
                            </div>

                            <button id="end-early-button" class="mt-8 w-full md:w-auto text-center bg-red-500/80 hover:bg-red-500/100 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-4 focus:ring-red-300/50 hover:scale-102 active:scale-98">
                                Ph√° v·ª° cam k·∫øt
                            </button>
                            <div id="post-session-controls" class="hidden mt-8 flex flex-col md:flex-row gap-4 justify-center">
                                <button id="start-break-button" class="w-full md:w-auto text-center bg-green-500/90 hover:bg-green-500/100 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-4 focus:ring-green-300/50 hover:scale-102 active:scale-98">
                                    Ngh·ªâ 5 ph√∫t
                                </button>
                                <button id="new-crystal-button" class="w-full md:w-auto text-center bg-purple-500/90 hover:bg-purple-500/100 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-4 focus:ring-purple-300/50 hover:scale-102 active:scale-98">
                                    Nu√¥i c·∫•y tinh th·ªÉ m·ªõi
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Early Exit Screen -->
    <div id="early-exit-screen" class="hidden">
        <div class="fixed inset-0 bg-red-100/90 dark:bg-red-900/60 backdrop-blur-sm z-50 flex flex-col items-center justify-center p-4 text-center">
            <div class="max-w-md">
                <svg id="crystal-svg-withered" width="300" height="300" viewBox="0 0 200 200" aria-label="M·ªôt tinh th·ªÉ v·ª°, ƒë·∫°i di·ªán cho phi√™n t·∫≠p trung kh√¥ng ho√†n th√†nh" class="mx-auto opacity-60">
                    <defs>
                        <linearGradient id="grad-main-withered" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#a855f7;stop-opacity:1" /><stop offset="100%" style="stop-color:#6366f1;stop-opacity:1" /></linearGradient>
                        <linearGradient id="grad-side-withered" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" /><stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" /></linearGradient>
                        <linearGradient id="grad-withered-withered" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#6b7280;stop-opacity:1" /><stop offset="100%" style="stop-color:#4b5563;stop-opacity:1" /></linearGradient>
                        <filter id="glow-filter-withered"><feGaussianBlur in="SourceGraphic" stdDeviation="10" /></filter>
                    </defs>
                    <g id="crystal-base-withered" style="opacity: 0; transition: opacity 1s ease;"><path d="M 10 190 Q 100 180 190 190" stroke="#a78bfa" stroke-width="2" fill="transparent" opacity="0.5"></path></g>
                    <g id="crystal-main-shard-withered" style="transform-origin: 50% 190px; transition: transform 1s ease-out; transform: scaleY(0);"><polygon points="100,50 115,130 100,190 85,130" fill="url(#grad-main-withered)"/></g>
                    <g id="crystal-left-shard-withered" style="transform-origin: 85px 190px; transition: transform 1s ease-out 0.2s; transform: scale(0);"><polygon points="85,130 60,150 80,190" fill="url(#grad-side-withered)"/></g>
                    <g id="crystal-right-shard-withered" style="transform-origin: 115px 190px; transition: transform 1s ease-out 0.2s; transform: scale(0);"><polygon points="115,130 140,150 120,190" fill="url(#grad-side-withered)"/></g>
                    <g id="crystal-glow-withered" style="transition: opacity 1s ease-out 0.5s; opacity: 0;"><path d="M 85 130 L 100 50 L 115 130 L 140 150 L 120 190 L 80 190 L 60 150 Z" fill="#c4b5fd" filter="url(#glow-filter-withered)" opacity="0.5"/></g>
                </svg>
                <h2 class="text-4xl font-bold text-red-900 dark:text-red-200 mb-4 mt-4">B·∫°n ƒëang ƒë√°nh m·∫•t phi√™n b·∫£n t·ªët h∆°n c·ªßa ch√≠nh m√¨nh.</h2>
                <p class="text-xl text-red-700 dark:text-red-300 mb-8">
                    Tinh th·ªÉ c·ªßa b·∫°n ƒë√£ v·ª° v√¨ cam k·∫øt b·ªã ph√° v·ª°.
                </p>
                <p class="text-md text-red-600 dark:text-red-400 mt-8 animate-pulse">
                    B·∫°n s·∫Ω ƒë∆∞·ª£c chuy·ªÉn v·ªÅ trang ch√≠nh trong gi√¢y l√°t...
                </p>
            </div>
        </div>
    </div>

    <!-- Weekly Review Screen -->
    <div id="weekly-review-screen" class="hidden">
        <div class="fixed inset-0 bg-slate-100/90 dark:bg-slate-900/90 backdrop-blur-sm z-50 flex flex-col items-center justify-center p-4">
            <div class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl shadow-2xl w-full max-w-2xl h-[90vh] flex flex-col">
                <header class="p-4 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center">
                    <h2 class="text-xl font-bold text-slate-800 dark:text-slate-200">üì¨ H·ªôp Th·ªùi Gian c·ªßa B·∫°n</h2>
                    <button id="close-review-btn" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300" aria-label="ƒê√≥ng">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                </header>
                <div class="p-6 flex-grow overflow-y-auto">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-slate-100 dark:bg-slate-900/50 p-4 rounded-lg">
                            <p class="text-sm text-slate-500 dark:text-slate-400">T·ªïng tinh th·ªÉ ƒë√£ nu√¥i</p>
                            <p id="review-total-crystals" class="text-3xl font-bold text-purple-600 dark:text-purple-400">0</p>
                        </div>
                        <div class="bg-slate-100 dark:bg-slate-900/50 p-4 rounded-lg">
                            <p class="text-sm text-slate-500 dark:text-slate-400">T·ªïng th·ªùi gian t·∫≠p trung</p>
                            <p id="review-total-time" class="text-3xl font-bold text-purple-600 dark:text-purple-400">0 gi·ªù</p>
                        </div>
                    </div>
                    <h3 class="text-lg font-semibold text-slate-700 dark:text-slate-300 mb-4">Nh·ªØng l√° th∆∞ t·ª´ qu√° kh·ª©</h3>
                    <div id="letters-container" class="space-y-4">
                        <p class="text-slate-500 dark:text-slate-400 text-center py-8">B·∫°n ch∆∞a vi·∫øt l√° th∆∞ n√†o. H√£y b·∫Øt ƒë·∫ßu m·ªôt phi√™n h·ªçc ƒë·ªÉ g·ª≠i g·∫Øm cam k·∫øt ƒë·∫ßu ti√™n!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="./index.js"></script>
</body>
</html>